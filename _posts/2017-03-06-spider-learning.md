---
layout: blog_detail
title: spider learning
excerpt_separator: <!--more-->
---
# 定时器 #
设置mmap threadhold,256K
设置SIGPIPE忽略
设置定时器处理
设置终端处理INT和TERM

默认配置文件为exvr_fetcher.cfg文件
LOG配置

读取配置文件:
	DebugLog配置影响LOG输出的配置LM_DEBUG

curl库的配置

创建10个信号量mutex

解析SpiderType\CheckInterval\ScanInterval

判断Scan和Check参数是否为空切是否个数相同

启动0-6类爬虫Scan流水

使用Poll Reactor模式启动ACE框架
	首先创建一个线程池，这个线程池中包括n个线程，每个线程都试图成为领导者，但领导者只能有一个，因此一旦某个线程竞争成为领导者，
	其他线程只能把自己定位为跟随者，并把与之相应的跟随者对象放在一个跟随者队列中，然后等待机会成为领导者，等待时跟随者线程处于挂起状态。
	那个竞争中成为领导者的线程，试图从消息队列中抓起消息，如果消息队列中没有消息，该线程也会处于挂起状态。
	一旦客户把一个消息放入队列（相当于添加了一个任务），领导者线程会被激活，并从消息队列中获取一条消息，然后它做的第一件事情是找一个新领导者，寻找算法就是简单的从跟随者队列的头部取出跟随者，指定它为新领导者，并激活该跟随者线程，当完成这些事情后，再去处理从队列中获取的消息，去执行相应的任务。
	等它完成任务处理后，它再去努力成为领导者，如果发现目前已经有领导者，只好把自己定位为跟随者，并把与之相对应的跟随者对象放入跟随者队列，等待机会成为领导者。

设置线程领导者是当前main所在线程


